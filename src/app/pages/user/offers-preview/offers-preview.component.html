<div class="h-full min-h-screen pt-4 pb-12">
    <div class="relative mx-auto rounded-xl max-w-7xl">
        <div class="absolute w-64 -translate-x-full -left-4">
            <ng-container *ngIf="!areObjectsEqual">
                <ng-container *ngIf="currentFilterValues">
                    <div class="flex flex-wrap gap-4 mt-2">
                        <div
                            *ngFor="
                                let multiOptionsfilter of multiOptionsFiltersConverted;
                                let i = index
                            "
                        >
                            <ng-container
                                *ngIf="
                                    multiOptionsfilter.length > 1 &&
                                    multiOptionsfilter.slice(1).length !==
                                        baseFilterValues.multiOptionsFilters[
                                            multiOptionsfilter[0]!
                                        ].length
                                "
                            >
                                <button
                                    (mouseover)="isHoveredMultiselect[i] = true"
                                    (mouseout)="isHoveredMultiselect[i] = false"
                                    (click)="
                                        clearMultiselectFilter(
                                            multiOptionsfilter[0]
                                        );
                                        isHoveredMultiselect[i] = false
                                    "
                                    class="mr-1.5 font-medium transition-colors duration-300 hover:text-red-600 text-neutral-500"
                                >
                                    {{
                                        multiOptionsfilter[0]
                                            | camelcaseToNormalCapitalized
                                    }}:
                                </button>

                                <ng-container
                                    *ngFor="
                                        let filterOption of multiOptionsfilter.slice(
                                            1
                                        );
                                        let innerIndex = index
                                    "
                                >
                                    <span
                                        [ngClass]="{
                                            'text-red-600':
                                                isHoveredMultiselect[i]
                                        }"
                                    >
                                        <button
                                            (click)="
                                                clearMultiselectFilterOption(
                                                    multiOptionsfilter[0],
                                                    filterOption
                                                )
                                            "
                                            class="transition-colors duration-300 hover:text-red-600"
                                        >
                                            {{ filterOption | titlecase }}
                                        </button>
                                        <span
                                            *ngIf="
                                                innerIndex + 2 !==
                                                multiOptionsfilter.length
                                            "
                                            class="transition-colors duration-300 select-none"
                                        >
                                            ,
                                        </span>
                                    </span>
                                </ng-container>
                            </ng-container>
                        </div>

                        <div
                            *ngFor="
                                let rangeFilter of rangeFiltersConverted;
                                let i = index
                            "
                        >
                            <ng-container
                                *ngIf="
                                    (rangeFilter[2] !==
                                        baseFilterValues.rangeFilters[
                                            rangeFilter[0]
                                        ][rangeFilter[0] + 'From'] ||
                                        rangeFilter[3] !==
                                            baseFilterValues.rangeFilters[
                                                rangeFilter[0]
                                            ][rangeFilter[0] + 'To']) &&
                                    rangeFilter[2] !== 0 &&
                                    rangeFilter[3] !== 0
                                "
                            >
                                <button
                                    (mouseover)="isHoveredRange[i] = true"
                                    (mouseout)="isHoveredRange[i] = false"
                                    (click)="
                                        clearMinMaxFilters(
                                            rangeFilter[0].toString()
                                        );
                                        isHoveredRange[i] = false
                                    "
                                    class="mr-1.5 transition-colors duration-300 hover:text-red-600 font-medium text-neutral-500"
                                >
                                    {{
                                        rangeFilter[0].toString()
                                            | camelcaseToNormalCapitalized
                                    }}:
                                </button>
                                <span
                                    [ngClass]="{
                                        'text-red-600': isHoveredRange[i]
                                    }"
                                >
                                    <button
                                        (click)="
                                            clearMinFilter(
                                                rangeFilter[0].toString()
                                            )
                                        "
                                        class="transition-colors duration-300 hover:text-red-600"
                                    >
                                        {{
                                            rangeFilter[2] | mask : "separator"
                                        }}
                                        {{ rangeFilter[1] }}
                                    </button>
                                    <span
                                        class="mx-1 transition-colors duration-300 select-none"
                                        >-</span
                                    >
                                    <button
                                        (click)="
                                            clearMaxFilter(
                                                rangeFilter[0].toString()
                                            )
                                        "
                                        class="transition-colors duration-300 hover:text-red-600"
                                    >
                                        {{
                                            rangeFilter[3] | mask : "separator"
                                        }}
                                        {{ rangeFilter[1] }}
                                    </button>
                                </span>
                            </ng-container>
                        </div>
                    </div>

                    <div
                        class="flex items-center self-center justify-center w-full gap-4"
                    >
                        <div
                            class="w-full mt-1 border border-white border-solid rounded-md"
                        ></div>

                        <div class="flex gap-1">
                            <button
                                type="button"
                                class="flex items-center text-lg font-semibold group whitespace-nowrap"
                            >
                                <div
                                    class="font-semibold transition-colors duration-300 group-hover:text-red-600"
                                >
                                    Clear all filters
                                </div>
                            </button>
                            <div
                                tooltip="Click any specific filter, or it's values to clear it."
                                placement="bottom"
                                class="w-8 h-8 mt-1 transition-transform duration-300 group"
                            >
                                <svg
                                    viewBox="0 -0.5 25 25"
                                    xmlns="http://www.w3.org/2000/svg"
                                >
                                    <path
                                        class="transition-colors duration-300 stroke-white group-hover:stroke-indigo-600"
                                        fill-rule="evenodd"
                                        clip-rule="evenodd"
                                        d="M5.5 11V13C5.5 16.3137 8.18629 19 11.5 19H13.5C16.8137 19 19.5 16.3137 19.5 13V11C19.5 7.68629 16.8137 5 13.5 5H11.5C8.18629 5 5.5 7.68629 5.5 11Z"
                                        stroke-width="1.5"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                    />
                                    <path
                                        class="transition-colors duration-300 stroke-white group-hover:stroke-indigo-600"
                                        d="M12.5 12V16"
                                        stroke-width="1.5"
                                        stroke-linecap="round"
                                    />
                                    <path
                                        class="transition-colors duration-300 stroke-white group-hover:stroke-indigo-600"
                                        d="M12.5 9.5C12.2243 9.5 12 9.2757 12 9C12 8.7243 12.2243 8.5 12.5 8.5C12.7757 8.5 13 8.7243 13 9C13 9.2757 12.7757 9.5 12.5 9.5Z"
                                    />
                                    <path
                                        class="transition-colors duration-300 stroke-white group-hover:stroke-indigo-600"
                                        d="M12.5 8C13.0523 8 13.5 8.44772 13.5 9C13.5 9.55228 13.0523 10 12.5 10C11.9477 10 11.5 9.55228 11.5 9C11.5 8.44772 11.9477 8 12.5 8Z"
                                    />
                                </svg>
                            </div>
                        </div>

                        <div
                            class="w-full mt-1 border border-white border-solid rounded-md"
                        ></div>
                    </div>
                </ng-container>
            </ng-container>
        </div>

        <ng-container
            *ngIf="
                availablefiltersValues$ | async as availablefiltersValues;
                else filtersLoading
            "
        >
            <div
                class="grid h-32 grid-cols-5"
                [ngClass]="{
                    'h-48': sliceFiltersTo === filterDropdowns.length
                }"
            >
                <app-dropdown-menu
                    *ngFor="
                        let dropdown of filterDropdowns.slice(
                            0,
                            sliceFiltersTo
                        );
                        let i = index
                    "
                    [dropdownName]="dropdown.dropdownName"
                    [dropdownWidth]="62"
                    [ngClass]="'z-' + (4 - Math.floor(i / 5)) * 10"
                >
                    <app-checkbox-input
                        *ngIf="dropdown.inputTypeProperties.type === 'checkbox'"
                        [dropdownOptions]="
                            availablefiltersValues.multiOptionsFilters[
                                dropdown.inputTypeProperties.filteringOption!
                            ]
                        "
                        [dropdownMultiselect]="
                            dropdown.inputTypeProperties.dropdownMultiselect
                        "
                        [connectedToFilter]="
                            dropdown.inputTypeProperties.filteringOption
                        "
                    ></app-checkbox-input>
                    <app-range-input
                        *ngIf="dropdown.inputTypeProperties.type === 'range'"
                        [minVal]="
                            currentFilterValues!.rangeFilters[
                                dropdown.inputTypeProperties.name!
                            ][dropdown.inputTypeProperties.name + 'From']
                        "
                        [maxVal]="
                            currentFilterValues!.rangeFilters[
                                dropdown.inputTypeProperties.name!
                            ][dropdown.inputTypeProperties.name + 'To']
                        "
                        [minimalValChange]="
                            dropdown.inputTypeProperties.minimalValChange
                        "
                        [suffix]="dropdown.inputTypeProperties.suffix"
                        [minOrMax]="dropdown.inputTypeProperties.minOrMax"
                        [ngxMask]="
                            dropdown.inputTypeProperties.mask
                                ? dropdown.inputTypeProperties.mask
                                : 'separator'
                        "
                        [filterGeneralName]="dropdown.inputTypeProperties.name!"
                        [connectedToFilter]="
                            dropdown.inputTypeProperties.filteringOption
                        "
                    ></app-range-input>
                </app-dropdown-menu>
            </div>

            <div
                class="flex items-center self-center justify-center w-full gap-4"
            >
                <div
                    class="w-full mt-1 border border-white border-solid rounded-md"
                ></div>

                <button
                    type="button"
                    (click)="toggleFiltersVisiblity()"
                    class="flex items-center text-lg font-semibold group whitespace-nowrap"
                >
                    <div
                        class="font-semibold transition-colors duration-300 group-hover:text-indigo-700"
                    >
                        {{
                            filtersVisibility
                                ? "Show less filters"
                                : "Show more filters"
                        }}
                    </div>
                    <div
                        class="w-8 h-8 mt-1 transition-transform duration-300 stroke-indigo-700"
                        [ngClass]="{ 'rotate-180': filtersVisibility }"
                    >
                        <svg
                            viewBox="0 0 24 24"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                class="transition-colors duration-300 stroke-white group-hover:stroke-indigo-700"
                                d="M7 10L12 15L17 10"
                                stroke="#ffffff"
                                stroke-width="1.5"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
                    </div>
                </button>

                <div
                    class="w-full mt-1 border border-white border-solid rounded-md"
                ></div>
            </div>

            <div class="flex flex-col items-start gap-2">
                <div class="grid w-full grid-cols-5 mx-auto mt-4">
                    <app-dropdown-menu
                        class="col-start-1"
                        [dropdownName]="sortingDropdown.dropdownName"
                        [dropdownWidth]="62"
                    >
                        <app-checkbox-input
                            (sortingChangeEvent)="sortingChange($event)"
                            *ngIf="
                                sortingDropdown.inputTypeProperties.type ===
                                'checkbox'
                            "
                            [dropdownOptions]="
                                sortingDropdown.inputTypeProperties
                                    .dropdownOptions
                            "
                            [dropdownMultiselect]="
                                sortingDropdown.inputTypeProperties
                                    .dropdownMultiselect
                            "
                        ></app-checkbox-input
                    ></app-dropdown-menu>

                    <app-dropdown-menu
                        class="col-start-2"
                        [dropdownName]="orderingDropdown.dropdownName"
                        [dropdownWidth]="62"
                    >
                        <app-checkbox-input
                            (orderingChangeEvent)="orderingChange($event)"
                            *ngIf="
                                orderingDropdown.inputTypeProperties.type ===
                                'checkbox'
                            "
                            [dropdownOptions]="
                                orderingDropdown.inputTypeProperties
                                    .dropdownOptions
                            "
                            [dropdownMultiselect]="
                                orderingDropdown.inputTypeProperties
                                    .dropdownMultiselect
                            "
                        ></app-checkbox-input
                    ></app-dropdown-menu>

                    <app-dropdown-menu
                        class="col-start-5"
                        [dropdownName]="offersPerPageDropdown.dropdownName"
                        [dropdownWidth]="62"
                    >
                        <app-checkbox-input
                            (maxOffersPerPageChangeEvent)="
                                maxOffersPerPageChange($event)
                            "
                            *ngIf="
                                offersPerPageDropdown.inputTypeProperties
                                    .type === 'checkbox'
                            "
                            [dropdownOptions]="
                                offersPerPageDropdown.inputTypeProperties
                                    .dropdownOptions
                            "
                            [dropdownMultiselect]="
                                offersPerPageDropdown.inputTypeProperties
                                    .dropdownMultiselect
                            "
                        ></app-checkbox-input>
                    </app-dropdown-menu>
                </div>

                <ng-container *ngIf="offersData$ | async as offersData">
                    <div
                        class="text-sm font-medium text-neutral-500 mt-14 ml-0.5"
                    >
                        Suitable
                        <span>
                            offer<span *ngIf="offersData.offersAmount > 1"
                                >s</span
                            >
                        </span>
                        found: {{ offersData.offersAmount }}
                    </div>
                </ng-container>
            </div>
        </ng-container>

        <ng-template #filtersLoading>
            <div class="grid h-32 grid-cols-5">
                <div
                    *ngFor="let x of [].constructor(10)"
                    data-placeholder
                    class="relative p-3 mb-2 overflow-hidden text-lg rounded-md text-neutral-900 w-62 bg-neutral-900"
                >
                    loading placeholder
                </div>
            </div>
        </ng-template>

        <ng-container
            *ngIf="offersData$ | async as offersData; else loadingOffers"
        >
            <ng-container
                *ngIf="offersData.offersAmount > 0; else noOffersTemplate"
            >
                <div class="flex flex-col w-full gap-4 mx-auto mt-4">
                    <div class="flex flex-col items-center w-full gap-6 mt-12">
                        <app-offer
                            *ngFor="let offer of offersData.offers"
                            [offerData]="offer"
                            class="w-full"
                        ></app-offer>
                    </div>
                </div>

                <div class="flex flex-col items-center gap-2 pb-4">
                    <div
                        class="flex items-start justify-center w-11/12 gap-4 mx-auto mt-16"
                    >
                        <button
                            *ngIf="currentPage !== 1"
                            class="flex items-center justify-center w-12 h-12 transition-colors duration-300 rounded-md cursor-pointer bg-neutral-950 backdrop-blur-3xl bg-opacity-90 bg-clip-padding backdrop-filter hover:bg-indigo-700 group"
                        >
                            <img
                                src="assets/svgs/arrow-left-5-svgrepo-com.svg"
                                class="w-10 h-10 transition-transform group-hover:-translate-x-0.5"
                                alt="left arrow icon"
                            />
                        </button>

                        <div class="flex flex-col items-center gap-2">
                            <div
                                class="flex text-xl rounded-md select-none bg-neutral-950 backdrop-blur-3xl bg-opacity-90 bg-clip-padding backdrop-filter"
                            >
                                <a
                                    *ngFor="
                                        let page of [].constructor(
                                            offersData.pagesAmount
                                        );
                                        let i = index
                                    "
                                    (click)="onPageChange(i + 1)"
                                    class="flex items-center justify-center w-12 h-12 transition-all duration-300 rounded-md cursor-pointer"
                                    [ngClass]="{
                                    'text-indigo-700 font-semibold cursor-default': i + 1 === currentPage,
                                    'hover:bg-indigo-700 hover:-translate-y-1': i + 1 !== currentPage,
                                }"
                                    >{{ i + 1 }}</a
                                >
                            </div>
                            <div class="text-xs opacity-50">
                                {{ currentPage }} of
                                {{ offersData.pagesAmount }}
                            </div>
                        </div>

                        <button
                            *ngIf="currentPage !== offersData.pagesAmount"
                            type="button"
                            class="flex items-center justify-center w-12 h-12 transition-colors duration-300 rounded-md cursor-pointer bg-neutral-950 backdrop-blur-3xl bg-opacity-90 bg-clip-padding backdrop-filter hover:bg-indigo-700 group"
                        >
                            <img
                                src="assets/svgs/right-arrow-svgrepo-com.svg"
                                class="w-10 h-10 transition-transform group-hover:translate-x-0.5"
                                alt="right arrow icon"
                            />
                        </button>
                    </div>
                </div>
            </ng-container>
            <ng-template #noOffersTemplate>
                <div class="flex flex-col gap-4 text-center mt-60">
                    <div class="text-5xl font-semibold">Oops!</div>
                    <div class="mb-2 text-2xl font-semibold">
                        No results match your search term.
                    </div>
                    <div class="text-xl opacity-80">
                        Perhaps you did some typo? Please check and try again.
                    </div>
                </div>
            </ng-template>
        </ng-container>

        <ng-template #loadingOffers>
            <div class="flex flex-col items-start gap-6 mt-24">
                <div
                    *ngFor="let x of [1, 2, 3, 4, 5, 6]"
                    role="status"
                    class="flex w-full gap-6"
                >
                    <div
                        data-placeholder
                        class="relative flex items-center justify-center h-48 overflow-hidden rounded bg-neutral-700 w-96"
                    >
                        <svg
                            class="w-10 h-10 text-neutral-500"
                            aria-hidden="true"
                            xmlns="http://www.w3.org/2000/svg"
                            fill="currentColor"
                            viewBox="0 0 20 18"
                        >
                            <path
                                d="M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"
                            />
                        </svg>
                    </div>
                    <div class="w-full mt-2">
                        <div
                            data-placeholder
                            class="relative w-48 h-3 mb-4 overflow-hidden rounded-full bg-neutral-700"
                        ></div>
                        <div
                            class="h-2 rounded-full bg-neutral-700 max-w-[480px] mb-2.5"
                        ></div>
                        <div
                            class="h-2 rounded-full bg-neutral-700 max-w-[680px] mb-6"
                        ></div>
                        <div
                            class="h-2 rounded-full bg-neutral-700 max-w-[440px] mb-2.5"
                        ></div>
                        <div
                            class="h-2 rounded-full bg-neutral-700 max-w-[460px] mb-2.5"
                        ></div>
                        <div
                            class="h-2 rounded-full bg-neutral-700 max-w-[320px] mb-2"
                        ></div>
                    </div>
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
        </ng-template>
    </div>
</div>
